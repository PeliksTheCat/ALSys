Imports System.IO.File
Imports System.IO.FileStream

Public Class Form1


    Private Sub Form1_Load_1(sender As Object, e As EventArgs) Handles MyBase.Load
        'TODO: This line of code loads data into the '_ALSYS_DatabaseDataSet.Database' table. You can move, or remove it, as needed.
        Me.DatabaseTableAdapter.Fill(Me._ALSYS_DatabaseDataSet.Database)
        Timer1.Enabled = True

    End Sub

    Private Sub Button4_Click(sender As Object, e As EventArgs) Handles Button4.Click
        DatabaseBindingSource.AddNew()
    End Sub

    Private Sub Button3_Click(sender As Object, e As EventArgs) Handles Button3.Click

        On Error GoTo SaveErr
        DatabaseBindingSource.EndEdit()
        DatabaseTableAdapter.Update(_ALSYS_DatabaseDataSet.Database)
        MessageBox.Show("Data Saved Succesfully")

SaveErr:
        Exit Sub

    End Sub

    Private Sub SearchToolStripButton_Click(sender As Object, e As EventArgs) Handles SearchToolStripButton.Click
        Try
            Me.DatabaseTableAdapter.Search(Me._ALSYS_DatabaseDataSet.Database, Last_NameToolStripTextBox.Text)
        Catch ex As System.Exception
            System.Windows.Forms.MessageBox.Show(ex.Message)
        End Try

    End Sub

    Private Sub Button8_Click(sender As Object, e As EventArgs) Handles Button8.Click
        DatabaseBindingSource.RemoveCurrent()
    End Sub

    Private Sub Button6_Click(sender As Object, e As EventArgs) Handles Button6.Click
        DatabaseBindingSource.MoveNext()
    End Sub

    Private Sub Button9_Click(sender As Object, e As EventArgs) Handles Button9.Click
        DatabaseBindingSource.MovePrevious()
    End Sub

    Private Sub Button10_Click(sender As Object, e As EventArgs) Handles Button10.Click
        Me.Close()
    End Sub

    Private Sub Button1_Click(sender As Object, e As EventArgs) Handles Button1.Click
        Dim Openfiledialog1 As New OpenFileDialog
        On Error GoTo Err
        OpenFileDialog1.ShowDialog()
        TextBox27.Text = OpenFileDialog1.FileName

Err:
        Exit Sub

    End Sub

    Private Sub TextBox27_TextChanged(sender As Object, e As EventArgs) Handles TextBox27.TextChanged
        If (System.IO.File.Exists(TextBox27.Text)) Then
            PictureBox1.Image = Image.FromFile(TextBox27.Text)
        End If

        If TextBox27.Text = "" Then
            PictureBox1.Hide()
        Else
            PictureBox1.Show()
        End If
    End Sub

    Private Sub Button2_Click(sender As Object, e As EventArgs) Handles Button2.Click
        TextBox27.Text = ""
    End Sub

    Private Sub Button7_Click(sender As Object, e As EventArgs) Handles Button7.Click
        DatabaseTableAdapter.Search(_ALSYS_DatabaseDataSet.Database, TextBox1.Text)
    End Sub

    Private Sub Timer1_Tick(sender As Object, e As EventArgs) Handles Timer1.Tick
        Label42.Text = Date.Now.ToString("MM-dd-yyyy  hh:mm:ss")
        Label37.Text = Date.Now.ToString("yyyy")
    End Sub
